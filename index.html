<!DOCTYPE html>
<html lang="fr" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OneBox - Plateforme de Stockage Personnel</title>
    <meta name="description" content="OneBox est un service de stockage local et sécurisé. Sauvegardez, organisez et éditez vos fichiers directement en local avec une interface moderne et intuitive.">
    
    <!-- Open Graph tags -->
    <meta property="og:title" content="OneBox - Plateforme de Stockage Personnel">
    <meta property="og:description" content="Votre cloud personnel sécurisé avec éditeur intégré et organisation de fichiers.">
    <meta property="og:type" content="website">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
    tailwind.config = {
        darkMode: ["class"],
        theme: {
            extend: {
                borderRadius: {
                    lg: "var(--radius)",
                    md: "calc(var(--radius) - 2px)",
                    sm: "calc(var(--radius) - 4px)",
                },
                colors: {
                    background: "hsl(var(--background))",
                    foreground: "hsl(var(--foreground))",
                    card: {
                        DEFAULT: "hsl(var(--card))",
                        foreground: "hsl(var(--card-foreground))",
                    },
                    popover: {
                        DEFAULT: "hsl(var(--popover))",
                        foreground: "hsl(var(--popover-foreground))",
                    },
                    primary: {
                        DEFAULT: "hsl(var(--primary))",
                        foreground: "hsl(var(--primary-foreground))",
                    },
                    secondary: {
                        DEFAULT: "hsl(var(--secondary))",
                        foreground: "hsl(var(--secondary-foreground))",
                    },
                    muted: {
                        DEFAULT: "hsl(var(--muted))",
                        foreground: "hsl(var(--muted-foreground))",
                    },
                    accent: {
                        DEFAULT: "hsl(var(--accent))",
                        foreground: "hsl(var(--accent-foreground))",
                    },
                    destructive: {
                        DEFAULT: "hsl(var(--destructive))",
                        foreground: "hsl(var(--destructive-foreground))",
                    },
                    border: "hsl(var(--border))",
                    input: "hsl(var(--input))",
                    ring: "hsl(var(--ring))",
                },
                fontFamily: {
                    sans: ["Inter", "sans-serif"],
                },
                keyframes: {
                    "accordion-down": {
                        from: { height: "0" },
                        to: { height: "var(--radix-accordion-content-height)" },
                    },
                    "accordion-up": {
                        from: { height: "var(--radix-accordion-content-height)" },
                        to: { height: "0" },
                    },
                    fadeIn: {
                        from: { opacity: "0", transform: "translateY(20px)" },
                        to: { opacity: "1", transform: "translateY(0)" },
                    },
                    spin: {
                        from: { transform: "rotate(0deg)" },
                        to: { transform: "rotate(360deg)" },
                    },
                    bounce: {
                        "0%, 100%": { 
                            transform: "translateY(-25%)",
                            animationTimingFunction: "cubic-bezier(0.8, 0, 1, 1)"
                        },
                        "50%": { 
                            transform: "translateY(0)",
                            animationTimingFunction: "cubic-bezier(0, 0, 0.2, 1)"
                        }
                    }
                },
                animation: {
                    "accordion-down": "accordion-down 0.2s ease-out",
                    "accordion-up": "accordion-up 0.2s ease-out",
                    "fade-in": "fadeIn 0.6s ease-out forwards",
                    "spin": "spin 1s linear infinite",
                    "bounce": "bounce 1s infinite",
                },
            },
        }
    };
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        :root {
            --background: 222 84% 5%;
            --foreground: 210 40% 98%;
            --card: 222 84% 8%;
            --card-foreground: 210 40% 98%;
            --popover: 222 84% 8%;
            --popover-foreground: 210 40% 98%;
            --primary: 180 83% 55%;
            --primary-foreground: 210 40% 98%;
            --secondary: 217 32% 17%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217 32% 14%;
            --muted-foreground: 215 20% 65%;
            --accent: 180 83% 55%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 84% 60%;
            --destructive-foreground: 210 40% 98%;
            --border: 217 32% 17%;
            --input: 217 32% 17%;
            --ring: 180 83% 55%;
            --radius: 0.75rem;
        }

        * {
            border-color: hsl(var(--border));
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
        }

        .gradient-bg {
            background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--accent)) 100%);
        }

        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .hover-lift:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(34, 197, 194, 0.2);
        }

        .file-hover {
            transition: all 0.2s ease;
        }

        .file-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(34, 197, 194, 0.1);
        }

        .nav-item {
            transition: all 0.2s ease;
        }

        .nav-item:hover {
            transform: translateX(2px);
        }

        .loading-spinner {
            border: 2px solid transparent;
            border-top: 2px solid hsl(var(--primary));
            border-radius: 50%;
        }

        .prose {
            max-width: none;
        }

        .prose p {
            margin-bottom: 1em;
        }

        .prose h1, .prose h2, .prose h3 {
            margin-top: 2em;
            margin-bottom: 1em;
            font-weight: 600;
        }

        .cube {
            width: 32px;
            height: 32px;
            position: relative;
            transform-style: preserve-3d;
            animation: rotateCube 6s infinite linear;
        }

        .cube-face {
            position: absolute;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(var(--accent)) 100%);
            border: 1px solid hsl(var(--border));
        }

        .cube-front { transform: translateZ(16px); }
        .cube-back { transform: rotateY(180deg) translateZ(16px); }
        .cube-right { transform: rotateY(90deg) translateZ(16px); }
        .cube-left { transform: rotateY(-90deg) translateZ(16px); }
        .cube-top { transform: rotateX(90deg) translateZ(16px); }
        .cube-bottom { transform: rotateX(-90deg) translateZ(16px); }

        @keyframes rotateCube {
            from { transform: rotateX(0deg) rotateY(0deg); }
            to { transform: rotateX(360deg) rotateY(360deg); }
        }

        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius) - 2px);
            padding: 16px 24px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            z-index: 100;
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            max-width: 400px;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.destructive {
            border-color: hsl(var(--destructive));
            background: hsl(var(--destructive) / 0.1);
        }

        .scrollbar-thin {
            scrollbar-width: thin;
            scrollbar-color: hsl(var(--muted)) transparent;
        }

        .scrollbar-thin::-webkit-scrollbar {
            width: 6px;
        }

        .scrollbar-thin::-webkit-scrollbar-track {
            background: transparent;
        }

        .scrollbar-thin::-webkit-scrollbar-thumb {
            background-color: hsl(var(--muted));
            border-radius: 20px;
        }

        /* Responsive styles for mobile, tablet, and desktop */
        @media (max-width: 640px) {
            .cube {
                width: 20px;
                height: 20px;
            }
            
            .cube-face {
                width: 20px;
                height: 20px;
            }
            
            .cube-front { transform: translateZ(10px); }
            .cube-back { transform: rotateY(180deg) translateZ(10px); }
            .cube-right { transform: rotateY(90deg) translateZ(10px); }
            .cube-left { transform: rotateY(-90deg) translateZ(10px); }
            .cube-top { transform: rotateX(90deg) translateZ(10px); }
            .cube-bottom { transform: rotateX(-90deg) translateZ(10px); }
            
            .toast {
                left: 10px;
                right: 10px;
                bottom: 10px;
                max-width: none;
            }
        }

        @media (max-width: 768px) {
            .nav-mobile {
                display: none;
            }
            
            .mobile-menu {
                display: block;
            }
        }

        @media (min-width: 769px) {
            .nav-mobile {
                display: flex;
            }
            
            .mobile-menu {
                display: none;
            }
        }
    </style>
</head>
<body class="bg-background text-foreground min-h-screen">

    <!-- Toast Container -->
    <div id="toastContainer" class="fixed bottom-2 sm:bottom-4 right-2 sm:right-4 left-2 sm:left-auto space-y-2 z-50"></div>

    <!-- Authentication Modal -->
    <div id="authModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center hidden">
        <div class="bg-card border border-border rounded-xl p-6 sm:p-8 w-full max-w-md mx-4 shadow-2xl max-h-[90vh] overflow-y-auto">
            <div id="loginForm" class="space-y-6">
                <div class="text-center">
                    <div class="flex justify-center mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="cube">
                                <div class="cube-face cube-front"></div>
                                <div class="cube-face cube-back"></div>
                                <div class="cube-face cube-right"></div>
                                <div class="cube-face cube-left"></div>
                                <div class="cube-face cube-top"></div>
                                <div class="cube-face cube-bottom"></div>
                            </div>
                            <h2 class="text-2xl font-bold text-foreground">OneBox</h2>
                        </div>
                    </div>
                    <h3 class="text-xl font-semibold text-foreground" data-testid="text-auth-prompt">Connexion</h3>
                    <p class="text-muted-foreground mt-2" data-testid="text-auth-description">Connectez-vous à votre compte OneBox</p>
                </div>
                
                <form class="space-y-4" onsubmit="handleLogin(event)">
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Nom d'utilisateur</label>
                        <input type="text" id="loginUsername" required
                               class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                               placeholder="Entrez votre nom d'utilisateur"
                               data-testid="input-username">
                    </div>
                    
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Mot de passe</label>
                        <input type="password" id="loginPassword" required
                               class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                               placeholder="Entrez votre mot de passe"
                               data-testid="input-password">
                    </div>
                    
                    <div class="space-y-3">
                        <button type="submit" class="w-full bg-primary text-primary-foreground py-2 px-4 rounded-md hover:opacity-90 transition-opacity"
                                data-testid="button-login">
                            <span id="loginButtonText">Se connecter</span>
                            <div id="loginSpinner" class="loading-spinner w-5 h-5 mx-auto hidden animate-spin"></div>
                        </button>
                        <div class="text-center">
                            <button type="button" onclick="showRegister()" 
                                    class="text-sm text-accent hover:underline"
                                    data-testid="button-toggle-mode">
                                Pas de compte ? Créez-en un
                            </button>
                        </div>
                    </div>
                </form>
            </div>
            
            <div id="registerForm" class="space-y-6 hidden">
                <div class="text-center">
                    <div class="flex justify-center mb-4">
                        <div class="flex items-center space-x-3">
                            <div class="cube">
                                <div class="cube-face cube-front"></div>
                                <div class="cube-face cube-back"></div>
                                <div class="cube-face cube-right"></div>
                                <div class="cube-face cube-left"></div>
                                <div class="cube-face cube-top"></div>
                                <div class="cube-face cube-bottom"></div>
                            </div>
                            <h2 class="text-2xl font-bold text-foreground">OneBox</h2>
                        </div>
                    </div>
                    <h3 class="text-xl font-semibold text-foreground" data-testid="text-auth-prompt">Créer un compte</h3>
                    <p class="text-muted-foreground mt-2" data-testid="text-auth-description">Créez votre compte OneBox</p>
                </div>
                
                <form class="space-y-4" onsubmit="handleRegister(event)">
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Nom d'utilisateur</label>
                        <input type="text" id="registerUsername" required
                               class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                               placeholder="Entrez votre nom d'utilisateur"
                               data-testid="input-username">
                    </div>
                    
                    <div class="space-y-2">
                        <label class="block text-sm font-medium">Mot de passe</label>
                        <input type="password" id="registerPassword" required
                               class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                               placeholder="Entrez votre mot de passe"
                               data-testid="input-password">
                    </div>
                    
                    <div class="space-y-3">
                        <button type="submit" class="w-full bg-primary text-primary-foreground py-2 px-4 rounded-md hover:opacity-90 transition-opacity"
                                data-testid="button-register">
                            <span id="registerButtonText">Créer un compte</span>
                            <div id="registerSpinner" class="loading-spinner w-5 h-5 mx-auto hidden animate-spin"></div>
                        </button>
                        <div class="text-center">
                            <button type="button" onclick="showLogin()" 
                                    class="text-sm text-accent hover:underline"
                                    data-testid="button-toggle-mode">
                                Déjà un compte ? Connectez-vous
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="hidden">
        <!-- Header -->
        <header class="bg-card border-b border-border px-4 sm:px-6 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-2 sm:space-x-4">
                <div class="flex items-center space-x-2 sm:space-x-3">
                    <div class="cube" style="width: 20px; height: 20px;">
                        <div class="cube-face cube-front" style="width: 20px; height: 20px;"></div>
                        <div class="cube-face cube-back" style="width: 20px; height: 20px;"></div>
                        <div class="cube-face cube-right" style="width: 20px; height: 20px;"></div>
                        <div class="cube-face cube-left" style="width: 20px; height: 20px;"></div>
                        <div class="cube-face cube-top" style="width: 20px; height: 20px;"></div>
                        <div class="cube-face cube-bottom" style="width: 20px; height: 20px;"></div>
                    </div>
                    <h1 class="text-xl sm:text-2xl font-bold text-foreground">OneBox</h1>
                </div>
                
                <!-- Desktop Navigation -->
                <div class="nav-mobile">
                    <div class="h-6 w-px bg-border"></div>
                    <nav class="flex space-x-6">
                        <button onclick="showSection('home')" class="nav-item text-foreground hover:text-primary transition-colors" data-section="home" data-testid="button-nav-home">
                            <i class="fas fa-home mr-2"></i>Accueil
                        </button>
                        <button onclick="showSection('storage')" class="nav-item text-muted-foreground hover:text-primary transition-colors" data-section="storage" data-testid="button-nav-storage">
                            <i class="fas fa-folder mr-2"></i>Mes fichiers
                        </button>
                        <button onclick="showSection('editor')" class="nav-item text-muted-foreground hover:text-primary transition-colors" data-section="editor" data-testid="button-nav-editor">
                            <i class="fas fa-edit mr-2"></i>Éditeur
                        </button>
                        <button onclick="showSection('help')" class="nav-item text-muted-foreground hover:text-primary transition-colors" data-section="help" data-testid="button-nav-help">
                            <i class="fas fa-question-circle mr-2"></i>Aide
                        </button>
                    </nav>
                </div>
                
                <!-- Mobile Menu Button -->
                <button onclick="toggleMobileMenu()" class="mobile-menu ml-4 p-2 rounded-md hover:bg-accent transition-colors md:hidden" data-testid="button-mobile-menu">
                    <i class="fas fa-bars text-foreground"></i>
                </button>
            </div>
            
            <div class="flex items-center space-x-2 sm:space-x-4">
                <div class="relative">
                    <button onclick="toggleProfileMenu()" class="flex items-center space-x-1 sm:space-x-2 hover:bg-accent rounded-lg p-2 transition-colors">
                        <div class="w-6 h-6 sm:w-8 sm:h-8 bg-primary rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-primary-foreground text-xs sm:text-sm"></i>
                        </div>
                        <span id="userNameDisplay" class="font-medium text-sm sm:text-base hidden sm:block">Utilisateur</span>
                        <i class="fas fa-chevron-down text-xs sm:text-sm text-muted-foreground hidden sm:block"></i>
                    </button>
                    
                    <div id="profileMenu" class="absolute right-0 mt-2 w-48 bg-card border border-border rounded-lg shadow-lg hidden z-10">
                        <div class="p-2">
                            <button onclick="showSection('profile')" class="w-full text-left px-3 py-2 hover:bg-accent rounded transition-colors" data-testid="button-profile">
                                <i class="fas fa-user mr-3"></i>Profil
                            </button>
                            <div class="border-t border-border my-2"></div>
                            <button onclick="handleLogout()" class="w-full text-left px-3 py-2 hover:bg-accent rounded transition-colors text-destructive" data-testid="button-logout">
                                <i class="fas fa-sign-out-alt mr-3"></i>Se déconnecter
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Mobile Navigation Menu -->
        <div id="mobileMenu" class="bg-card border-b border-border px-4 py-4 space-y-2 hidden md:hidden">
            <button onclick="showSection('home'); closeMobileMenu()" class="w-full text-left px-3 py-2 rounded hover:bg-accent transition-colors" data-section="home" data-testid="button-nav-home-mobile">
                <i class="fas fa-home mr-3"></i>Accueil
            </button>
            <button onclick="showSection('storage'); closeMobileMenu()" class="w-full text-left px-3 py-2 rounded hover:bg-accent transition-colors" data-section="storage" data-testid="button-nav-storage-mobile">
                <i class="fas fa-folder mr-3"></i>Mes fichiers
            </button>
            <button onclick="showSection('editor'); closeMobileMenu()" class="w-full text-left px-3 py-2 rounded hover:bg-accent transition-colors" data-section="editor" data-testid="button-nav-editor-mobile">
                <i class="fas fa-edit mr-3"></i>Éditeur
            </button>
            <button onclick="showSection('help'); closeMobileMenu()" class="w-full text-left px-3 py-2 rounded hover:bg-accent transition-colors" data-section="help" data-testid="button-nav-help-mobile">
                <i class="fas fa-question-circle mr-3"></i>Aide
            </button>
        </div>

        <!-- Home Section -->
        <div id="home" class="section" data-testid="home-page">
            <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-12">
                <div class="text-center space-y-6 sm:space-y-8">
                    <div class="space-y-3 sm:space-y-4">
                        <h1 class="text-3xl sm:text-4xl md:text-6xl font-bold text-foreground leading-tight" data-testid="text-hero-title">
                            Votre cloud <span class="text-accent">personnel</span>
                        </h1>
                        <p class="text-lg sm:text-xl text-muted-foreground max-w-3xl mx-auto px-4" data-testid="text-hero-description">
                            OneBox est un service de stockage local et sécurisé. Sauvegardez, organisez et éditez vos fichiers directement en local avec une interface moderne et intuitive.
                        </p>
                    </div>
                    
                    <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 justify-center px-4">
                        <button onclick="showSection('storage')" class="bg-primary text-primary-foreground px-6 sm:px-8 py-3 rounded-lg text-base sm:text-lg font-medium hover:opacity-90 transition-opacity" data-testid="button-get-started">
                            Commencer
                        </button>
                        <button onclick="showSection('help')" class="bg-secondary text-secondary-foreground px-6 sm:px-8 py-3 rounded-lg text-base sm:text-lg font-medium hover:bg-accent transition-colors" data-testid="button-learn-more">
                            En savoir plus
                        </button>
                    </div>
                </div>
                
                <!-- Features Grid -->
                <div class="mt-12 sm:mt-20 grid sm:grid-cols-2 md:grid-cols-3 gap-6 sm:gap-8 px-4">
                    <div class="bg-card p-6 rounded-xl border border-border file-hover" data-testid="feature-security">
                        <div class="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-shield-alt text-accent text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-foreground mb-2" data-testid="text-feature-security-title">
                            Sécurisé
                        </h3>
                        <p class="text-muted-foreground" data-testid="text-feature-security-description">
                            Vos données restent locales avec une authentification Face ID avancée.
                        </p>
                    </div>

                    <div class="bg-card p-6 rounded-xl border border-border file-hover" data-testid="feature-editor">
                        <div class="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-edit text-accent text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-foreground mb-2" data-testid="text-feature-editor-title">
                            Éditeur intégré
                        </h3>
                        <p class="text-muted-foreground" data-testid="text-feature-editor-description">
                            Créez et modifiez vos documents directement dans l'interface.
                        </p>
                    </div>

                    <div class="bg-card p-6 rounded-xl border border-border file-hover" data-testid="feature-organization">
                        <div class="w-12 h-12 bg-primary/20 rounded-lg flex items-center justify-center mb-4">
                            <i class="fas fa-folder-tree text-accent text-xl"></i>
                        </div>
                        <h3 class="text-xl font-semibold text-foreground mb-2" data-testid="text-feature-organization-title">
                            Organisation
                        </h3>
                        <p class="text-muted-foreground" data-testid="text-feature-organization-description">
                            Organisez vos fichiers en dossiers avec un partage local facile.
                        </p>
                    </div>
                </div>
            </main>
        </div>

        <!-- Storage Section -->
        <div id="storage" class="section hidden" data-testid="storage-page">
            <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-8">
                <!-- Storage Header -->
                <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 sm:mb-8">
                    <div class="mb-4 sm:mb-0">
                        <h1 class="text-2xl sm:text-3xl font-bold text-foreground" data-testid="text-page-title">
                            Mes fichiers
                        </h1>
                        <p class="text-muted-foreground mt-1" data-testid="text-page-description">
                            Gérez et organisez votre stockage local
                        </p>
                    </div>
                    <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4">
                        <button onclick="showCreateFolder()" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-new-folder">
                            <i class="fas fa-plus mr-2"></i>Nouveau dossier
                        </button>
                        <button onclick="triggerFileUpload()" class="bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-accent transition-colors" data-testid="button-upload">
                            <i class="fas fa-upload mr-2"></i>Importer
                        </button>
                    </div>
                </div>

                <!-- Create folder input -->
                <div id="createFolderSection" class="bg-card border border-border rounded-xl p-4 sm:p-6 mb-6 hidden">
                    <div class="flex flex-col sm:flex-row sm:items-center space-y-3 sm:space-y-0 sm:space-x-4">
                        <input type="text" id="newFolderName" 
                               class="flex-1 px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                               placeholder="Nom du dossier"
                               data-testid="input-folder-name">
                        <div class="flex space-x-2">
                            <button onclick="createFolder()" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-create-folder">
                                Créer
                            </button>
                            <button onclick="hideCreateFolder()" class="bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-accent transition-colors" data-testid="button-cancel-folder">
                                Annuler
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Drag & Drop Upload Zone -->
                <div id="uploadZone" class="bg-card border-2 border-dashed border-border hover:border-accent rounded-xl p-6 sm:p-8 mb-6 sm:mb-8 text-center transition-colors" data-testid="upload-zone">
                    <div class="space-y-3 sm:space-y-4">
                        <div class="w-12 h-12 sm:w-16 sm:h-16 bg-primary/20 rounded-full flex items-center justify-center mx-auto">
                            <i class="fas fa-cloud-upload-alt text-accent text-xl sm:text-2xl"></i>
                        </div>
                        <div>
                            <p class="text-base sm:text-lg font-medium text-foreground" data-testid="text-upload-title">
                                Glissez vos fichiers ici
                            </p>
                            <p class="text-sm sm:text-base text-muted-foreground" data-testid="text-upload-description">
                                ou cliquez pour parcourir
                            </p>
                        </div>
                        <button onclick="triggerFileUpload()" class="bg-primary text-primary-foreground px-4 sm:px-6 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-choose-files">
                            Choisir des fichiers
                        </button>
                    </div>
                </div>

                <input type="file" id="fileInput" multiple class="hidden" onchange="handleFileUpload(event)" data-testid="file-input">
                
                <!-- Files and Folders Grid -->
                <div id="filesGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4 sm:gap-6">
                    <!-- Empty state -->
                    <div id="emptyState" class="col-span-full text-center py-8 sm:py-12" data-testid="empty-state">
                        <div class="w-12 h-12 sm:w-16 sm:h-16 bg-muted rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas fa-folder text-muted-foreground text-xl sm:text-2xl"></i>
                        </div>
                        <h3 class="text-base sm:text-lg font-medium text-foreground mb-2">Aucun fichier</h3>
                        <p class="text-sm sm:text-base text-muted-foreground px-4">Commencez par uploader vos premiers fichiers</p>
                    </div>
                </div>
            </main>
        </div>

        <!-- Editor Section -->
        <div id="editor" class="section hidden h-screen flex flex-col" data-testid="editor-page">
            <!-- Editor Header -->
            <div class="bg-card border-b border-border px-3 sm:px-4 py-3 flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0">
                <div class="flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-4">
                    <h1 class="text-base sm:text-lg font-semibold text-foreground" data-testid="text-editor-title">
                        Éditeur de documents
                    </h1>
                    <input type="text" id="documentTitle" 
                           class="px-3 py-1 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent w-full sm:max-w-xs"
                           placeholder="Titre du document"
                           value="Document sans titre"
                           data-testid="input-document-title">
                    <span id="unsavedIndicator" class="text-xs sm:text-sm text-muted-foreground hidden" data-testid="text-unsaved-indicator">
                        Non sauvegardé
                    </span>
                </div>
                <div class="flex items-center space-x-2">
                    <button onclick="saveDocument()" class="bg-primary text-primary-foreground px-3 sm:px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-save">
                        <i class="fas fa-save mr-1 sm:mr-2"></i><span id="saveButtonText" class="text-sm sm:text-base">Sauvegarder</span>
                    </button>
                    <button onclick="toggleEditorTheme()" class="p-2 hover:bg-accent rounded-lg transition-colors" data-testid="button-toggle-theme">
                        <i id="themeIcon" class="fas fa-sun text-muted-foreground"></i>
                    </button>
                </div>
            </div>
            
            <!-- Editor Toolbar -->
            <div class="bg-card border-b border-border px-2 sm:px-4 py-2 flex items-center space-x-1 overflow-x-auto">
                <button onclick="execCommand('bold')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-bold">
                    <i class="fas fa-bold text-xs sm:text-sm"></i>
                </button>
                <button onclick="execCommand('italic')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-italic">
                    <i class="fas fa-italic text-xs sm:text-sm"></i>
                </button>
                <button onclick="execCommand('underline')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-underline">
                    <i class="fas fa-underline text-xs sm:text-sm"></i>
                </button>
                <div class="w-px h-4 sm:h-6 bg-border mx-1 sm:mx-2 flex-shrink-0"></div>
                
                <!-- Color Picker -->
                <div class="relative flex-shrink-0">
                    <button onclick="toggleColorPicker()" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex items-center" data-testid="button-text-color">
                        <i class="fas fa-palette text-xs sm:text-sm mr-1"></i>
                        <div id="currentColor" class="w-3 h-3 rounded border border-border" style="background-color: #000000;"></div>
                    </button>
                    <div id="colorPicker" class="hidden absolute top-full left-0 mt-1 bg-card border border-border rounded-lg shadow-lg p-3 z-10">
                        <div class="grid grid-cols-6 gap-1 mb-2">
                            <button onclick="setTextColor('#000000')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #000000;"></button>
                            <button onclick="setTextColor('#ff0000')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #ff0000;"></button>
                            <button onclick="setTextColor('#00ff00')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #00ff00;"></button>
                            <button onclick="setTextColor('#0000ff')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #0000ff;"></button>
                            <button onclick="setTextColor('#ffff00')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #ffff00;"></button>
                            <button onclick="setTextColor('#ff00ff')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #ff00ff;"></button>
                            <button onclick="setTextColor('#00ffff')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #00ffff;"></button>
                            <button onclick="setTextColor('#ffa500')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #ffa500;"></button>
                            <button onclick="setTextColor('#800080')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #800080;"></button>
                            <button onclick="setTextColor('#008000')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #008000;"></button>
                            <button onclick="setTextColor('#ffc0cb')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #ffc0cb;"></button>
                            <button onclick="setTextColor('#a52a2a')" class="w-6 h-6 rounded border border-border hover:scale-110 transition-transform" style="background-color: #a52a2a;"></button>
                        </div>
                        <input type="color" id="customColorInput" onchange="setTextColor(this.value)" class="w-full h-8 rounded border border-border">
                    </div>
                </div>
                
                <div class="w-px h-4 sm:h-6 bg-border mx-1 sm:mx-2 flex-shrink-0"></div>
                <button onclick="execCommand('justifyLeft')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-align-left">
                    <i class="fas fa-align-left text-xs sm:text-sm"></i>
                </button>
                <button onclick="execCommand('justifyCenter')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-align-center">
                    <i class="fas fa-align-center text-xs sm:text-sm"></i>
                </button>
                <button onclick="execCommand('justifyRight')" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-align-right">
                    <i class="fas fa-align-right text-xs sm:text-sm"></i>
                </button>
                <div class="w-px h-4 sm:h-6 bg-border mx-1 sm:mx-2 flex-shrink-0"></div>
                <button onclick="insertImage()" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-insert-image">
                    <i class="fas fa-image text-xs sm:text-sm"></i>
                </button>
                <button onclick="insertTable()" class="p-1.5 sm:p-2 hover:bg-accent rounded transition-colors flex-shrink-0" data-testid="button-insert-table">
                    <i class="fas fa-table text-xs sm:text-sm"></i>
                </button>
            </div>
            
            <!-- Editor Content -->
            <div class="flex-1 bg-background p-4 sm:p-8 overflow-auto">
                <div id="editorContainer" class="max-w-4xl mx-auto rounded-lg shadow-lg min-h-full p-4 sm:p-8 bg-card text-foreground">
                    <div id="editorContent" 
                         class="prose prose-sm sm:prose-lg max-w-none outline-none min-h-96"
                         contenteditable="true"
                         data-testid="editor-content"
                         oninput="handleEditorChange()">
                        <p>Commencez à écrire votre document ici...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profile" class="section hidden" data-testid="profile-page">
            <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-12">
                <div class="mb-6 sm:mb-8">
                    <h1 class="text-2xl sm:text-3xl font-bold text-foreground mb-4" data-testid="text-page-title">
                        Profil et paramètres
                    </h1>
                    <p class="text-muted-foreground" data-testid="text-page-description">
                        Gérez votre compte et vos préférences
                    </p>
                </div>

                <div class="grid gap-6 sm:gap-8">
                    <!-- Personal Information -->
                    <div class="bg-card border border-border rounded-xl p-4 sm:p-6" data-testid="card-personal-info">
                        <div class="flex items-center gap-2 mb-4 sm:mb-6">
                            <i class="fas fa-user text-primary"></i>
                            <h2 class="text-lg sm:text-xl font-semibold">Informations personnelles</h2>
                        </div>
                        <div class="space-y-4">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium">Nom d'utilisateur</label>
                                <input type="text" id="profileUsername" 
                                       class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                                       data-testid="input-username">
                            </div>
                            <button onclick="saveProfile()" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-save-profile">
                                Sauvegarder les modifications
                            </button>
                        </div>
                    </div>

                    <!-- Security Settings -->
                    <div class="bg-card border border-border rounded-xl p-4 sm:p-6" data-testid="card-security">
                        <div class="flex items-center gap-2 mb-4 sm:mb-6">
                            <i class="fas fa-shield-alt text-primary"></i>
                            <h2 class="text-lg sm:text-xl font-semibold">Sécurité</h2>
                        </div>
                        <div class="space-y-6">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-base font-medium">Face ID</p>
                                    <p class="text-sm text-muted-foreground">
                                        Utilisez Face ID pour vous connecter rapidement
                                    </p>
                                </div>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="faceIdToggle" class="sr-only peer" data-testid="switch-face-id">
                                    <div class="w-11 h-6 bg-secondary peer-focus:ring-4 peer-focus:ring-primary/25 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                                </label>
                            </div>
                            
                            <div class="pt-4 border-t border-border">
                                <button class="bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-accent transition-colors" data-testid="button-change-password">
                                    Changer le mot de passe
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Appearance Settings -->
                    <div class="bg-card border border-border rounded-xl p-4 sm:p-6" data-testid="card-appearance">
                        <div class="flex items-center gap-2 mb-4 sm:mb-6">
                            <i class="fas fa-palette text-primary"></i>
                            <h2 class="text-lg sm:text-xl font-semibold">Apparence</h2>
                        </div>
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-base font-medium">Mode sombre</p>
                                <p class="text-sm text-muted-foreground">
                                    Activer le thème sombre pour réduire la fatigue oculaire
                                </p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="darkModeToggle" class="sr-only peer" checked data-testid="switch-dark-mode">
                                <div class="w-11 h-6 bg-secondary peer-focus:ring-4 peer-focus:ring-primary/25 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-primary"></div>
                            </label>
                        </div>
                    </div>

                    <!-- Language Settings -->
                    <div class="bg-card border border-border rounded-xl p-4 sm:p-6" data-testid="card-language">
                        <div class="flex items-center gap-2 mb-4 sm:mb-6">
                            <i class="fas fa-globe text-primary"></i>
                            <h2 class="text-lg sm:text-xl font-semibold">Langue et région</h2>
                        </div>
                        <div class="space-y-2">
                            <label class="block text-sm font-medium">Langue</label>
                            <select id="languageSelect" 
                                    class="w-full px-3 py-2 bg-input border border-border rounded-md focus:ring-2 focus:ring-primary focus:border-transparent"
                                    data-testid="select-language">
                                <option value="fr">Français</option>
                                <option value="en">English</option>
                                <option value="es">Español</option>
                            </select>
                        </div>
                    </div>

                    <!-- Account Actions -->
                    <div class="bg-card border border-border rounded-xl p-6" data-testid="card-account-actions">
                        <div class="flex items-center gap-2 mb-6">
                            <i class="fas fa-cog text-primary"></i>
                            <h2 class="text-xl font-semibold">Actions du compte</h2>
                        </div>
                        <div class="flex flex-col sm:flex-row gap-4">
                            <button class="bg-secondary text-secondary-foreground px-4 py-2 rounded-lg hover:bg-accent transition-colors" data-testid="button-export-data">
                                Exporter mes données
                            </button>
                            <button onclick="handleLogout()" class="bg-destructive text-destructive-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-logout">
                                Se déconnecter
                            </button>
                        </div>
                    </div>
                </div>
            </main>
        </div>

        <!-- Help Section -->
        <div id="help" class="section hidden" data-testid="help-page">
            <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
                <div class="text-center mb-12">
                    <h1 class="text-3xl font-bold text-foreground mb-4" data-testid="text-page-title">
                        Centre d'aide
                    </h1>
                    <p class="text-xl text-muted-foreground" data-testid="text-page-description">
                        Découvrez comment utiliser OneBox
                    </p>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="bg-card border border-border rounded-xl p-6" data-testid="help-upload">
                        <h3 class="text-xl font-semibold text-foreground mb-4" data-testid="text-help-upload-title">
                            Comment uploader des fichiers ?
                        </h3>
                        <p class="text-muted-foreground mb-4" data-testid="text-help-upload-description">
                            Glissez-déposez vos fichiers directement dans la zone de stockage ou utilisez le bouton "Importer".
                        </p>
                        <button onclick="showModal('uploadTutorialModal')" class="text-accent hover:underline font-medium" data-testid="button-help-upload-learn-more">
                            Lire le tutoriel <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="bg-card border border-border rounded-xl p-6" data-testid="help-editor">
                        <h3 class="text-xl font-semibold text-foreground mb-4" data-testid="text-help-editor-title">
                            Comment utiliser l'éditeur ?
                        </h3>
                        <p class="text-muted-foreground mb-4" data-testid="text-help-editor-description">
                            L'éditeur intégré permet de créer et modifier des documents avec un formatage riche.
                        </p>
                        <button onclick="showModal('editorTutorialModal')" class="text-accent hover:underline font-medium" data-testid="button-help-editor-learn-more">
                            Lire le tutoriel <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="bg-card border border-border rounded-xl p-6" data-testid="help-sharing">
                        <h3 class="text-xl font-semibold text-foreground mb-4" data-testid="text-help-sharing-title">
                            Comment partager des fichiers ?
                        </h3>
                        <p class="text-muted-foreground mb-4" data-testid="text-help-sharing-description">
                            Générez des liens internes pour partager vos fichiers localement en toute sécurité.
                        </p>
                        <button onclick="showModal('sharingTutorialModal')" class="text-accent hover:underline font-medium" data-testid="button-help-sharing-learn-more">
                            Lire le tutoriel <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>

                    <div class="bg-card border border-border rounded-xl p-6" data-testid="help-contact">
                        <h3 class="text-xl font-semibold text-foreground mb-4" data-testid="text-help-contact-title">
                            Contact
                        </h3>
                        <p class="text-muted-foreground mb-4" data-testid="text-help-contact-description">
                            Besoin d'aide ? Contactez notre équipe de support.
                        </p>
                        <button onclick="showModal('contactModal')" class="text-accent hover:underline font-medium" data-testid="button-help-contact-learn-more">
                            Nous contacter <i class="fas fa-arrow-right ml-1"></i>
                        </button>
                    </div>
                </div>

                <!-- FAQ Section -->
                <div class="mt-16">
                    <h2 class="text-2xl font-bold text-foreground mb-8 text-center" data-testid="text-faq-title">
                        Questions fréquentes
                    </h2>
                    
                    <div class="space-y-6">
                        <div class="bg-card border border-border rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-foreground mb-2" data-testid="text-faq-security-title">
                                Mes données sont-elles sécurisées ?
                            </h3>
                            <p class="text-muted-foreground" data-testid="text-faq-security-answer">
                                Oui, OneBox stocke toutes vos données localement sur votre appareil. Aucune donnée n'est envoyée vers des serveurs externes.
                            </p>
                        </div>

                        <div class="bg-card border border-border rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-foreground mb-2" data-testid="text-faq-space-title">
                                Quelle est la limite de stockage ?
                            </h3>
                            <p class="text-muted-foreground" data-testid="text-faq-space-answer">
                                La limite de stockage dépend de l'espace disponible sur votre appareil. OneBox utilise le stockage local de votre navigateur.
                            </p>
                        </div>

                        <div class="bg-card border border-border rounded-xl p-6">
                            <h3 class="text-lg font-semibold text-foreground mb-2" data-testid="text-faq-access-title">
                                Comment accéder à mes fichiers depuis un autre appareil ?
                            </h3>
                            <p class="text-muted-foreground" data-testid="text-faq-access-answer">
                                OneBox est conçu pour un usage local. Pour accéder à vos fichiers depuis un autre appareil, vous devez les synchroniser manuellement.
                            </p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let currentSection = 'home';
        let files = [];
        let folders = [];
        let documents = [];
        let hasUnsavedChanges = false;
        let editorDarkMode = true;

        // Initialize the application
        (function() {
            // Check for existing authentication
            const savedUser = localStorage.getItem('oneboxUser');
            const savedFiles = localStorage.getItem('oneboxFiles');
            const savedFolders = localStorage.getItem('oneboxFolders');
            const savedDocuments = localStorage.getItem('oneboxDocuments');

            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showMainApp();
            } else {
                showAuthModal();
            }

            if (savedFiles) {
                files = JSON.parse(savedFiles);
            }

            if (savedFolders) {
                folders = JSON.parse(savedFolders);
            }

            if (savedDocuments) {
                documents = JSON.parse(savedDocuments);
            }

            // Setup drag and drop for upload zone
            setupDragAndDrop();
            
            // Setup editor change tracking
            setupEditorTracking();
        })();

        // Toast notification system
        function showToast(title, description, variant = 'default') {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${variant === 'destructive' ? 'destructive' : ''}`;
            
            toast.innerHTML = `
                <div class="flex items-start space-x-3">
                    <div class="flex-1">
                        <p class="font-semibold text-sm">${title}</p>
                        <p class="text-sm text-muted-foreground">${description}</p>
                    </div>
                    <button onclick="this.parentElement.parentElement.remove()" class="text-muted-foreground hover:text-foreground">
                        <i class="fas fa-times text-sm"></i>
                    </button>
                </div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Show toast
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (toast.parentElement) {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }
            }, 5000);
        }

        // Authentication Functions
        function showAuthModal() {
            document.getElementById('authModal').classList.remove('hidden');
            document.getElementById('mainApp').classList.add('hidden');
        }

        function hideAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('mainApp').classList.remove('hidden');
        }

        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('registerForm').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.remove('hidden');
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!username || !password) {
                showToast('Champs requis', 'Veuillez remplir tous les champs', 'destructive');
                return;
            }
            
            // Show loading state
            const buttonText = document.getElementById('loginButtonText');
            const spinner = document.getElementById('loginSpinner');
            buttonText.classList.add('hidden');
            spinner.classList.remove('hidden');
            
            // Simulate authentication delay
            setTimeout(() => {
                currentUser = {
                    id: generateId(),
                    username: username,
                    loginTime: new Date().toISOString()
                };
                
                // Save to localStorage for persistence
                localStorage.setItem('oneboxUser', JSON.stringify(currentUser));
                
                // Hide loading state
                buttonText.classList.remove('hidden');
                spinner.classList.add('hidden');
                
                // Show success message
                showToast('Connexion réussie', 'Bienvenue dans OneBox !');
                
                // Show main application
                showMainApp();
            }, 1500);
        }

        function handleRegister(event) {
            event.preventDefault();
            
            const username = document.getElementById('registerUsername').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!username || !password) {
                showToast('Champs requis', 'Veuillez remplir tous les champs', 'destructive');
                return;
            }
            
            // Show loading state
            const buttonText = document.getElementById('registerButtonText');
            const spinner = document.getElementById('registerSpinner');
            buttonText.classList.add('hidden');
            spinner.classList.remove('hidden');
            
            // Simulate registration delay
            setTimeout(() => {
                currentUser = {
                    id: generateId(),
                    username: username,
                    loginTime: new Date().toISOString()
                };
                
                // Save to localStorage for persistence
                localStorage.setItem('oneboxUser', JSON.stringify(currentUser));
                
                // Hide loading state
                buttonText.classList.remove('hidden');
                spinner.classList.add('hidden');
                
                // Show success message
                showToast('Compte créé', 'Bienvenue dans OneBox !');
                
                // Show main application
                showMainApp();
            }, 1500);
        }

        function handleLogout() {
            currentUser = null;
            localStorage.removeItem('oneboxUser');
            hideProfileMenu();
            showAuthModal();
            
            // Reset forms
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('registerUsername').value = '';
            document.getElementById('registerPassword').value = '';
            
            showToast('Déconnexion', 'Vous avez été déconnecté avec succès');
        }

        function showMainApp() {
            hideAuthModal();
            if (currentUser) {
                document.getElementById('userNameDisplay').textContent = currentUser.username;
                document.getElementById('profileUsername').value = currentUser.username;
            }
            showSection('home');
            renderFilesGrid();
        }

        // Navigation Functions
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.classList.add('hidden'));
            
            // Show target section
            document.getElementById(sectionName).classList.remove('hidden');
            
            // Update navigation active states
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                if (item.dataset.section === sectionName) {
                    item.classList.remove('text-muted-foreground');
                    item.classList.add('text-foreground');
                } else {
                    item.classList.remove('text-foreground');
                    item.classList.add('text-muted-foreground');
                }
            });
            
            currentSection = sectionName;
            
            // Section-specific actions
            if (sectionName === 'storage') {
                renderFilesGrid();
            }
        }

        // Profile Menu Functions
        function toggleProfileMenu() {
            const menu = document.getElementById('profileMenu');
            menu.classList.toggle('hidden');
        }

        function hideProfileMenu() {
            document.getElementById('profileMenu').classList.add('hidden');
        }

        // Storage Functions
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }

        function showCreateFolder() {
            document.getElementById('createFolderSection').classList.remove('hidden');
            document.getElementById('newFolderName').focus();
        }

        function hideCreateFolder() {
            document.getElementById('createFolderSection').classList.add('hidden');
            document.getElementById('newFolderName').value = '';
        }

        function createFolder() {
            const name = document.getElementById('newFolderName').value.trim();
            if (!name) return;

            const folder = {
                id: generateId(),
                name: name,
                createdAt: new Date().toISOString(),
                userId: currentUser.id
            };

            folders.push(folder);
            localStorage.setItem('oneboxFolders', JSON.stringify(folders));
            
            hideCreateFolder();
            renderFilesGrid();
            showToast('Dossier créé', 'Le dossier a été créé avec succès');
        }

        function deleteFolder(folderId) {
            folders = folders.filter(f => f.id !== folderId);
            localStorage.setItem('oneboxFolders', JSON.stringify(folders));
            renderFilesGrid();
            showToast('Dossier supprimé', 'Le dossier a été supprimé avec succès');
        }

        function triggerFileUpload() {
            document.getElementById('fileInput').click();
        }

        function handleFileUpload(event) {
            const selectedFiles = Array.from(event.target.files);
            selectedFiles.forEach(file => uploadFile(file));
            event.target.value = ''; // Reset input
        }

        function uploadFile(file) {
            const fileRecord = {
                id: generateId(),
                originalName: file.name,
                size: file.size,
                mimeType: file.type,
                createdAt: new Date().toISOString(),
                userId: currentUser.id
            };

            // Store file data as base64 (for demo purposes)
            const reader = new FileReader();
            reader.onload = function(e) {
                fileRecord.data = e.target.result;
                files.push(fileRecord);
                localStorage.setItem('oneboxFiles', JSON.stringify(files));
                renderFilesGrid();
                showToast('Fichier uploadé', 'Le fichier a été uploadé avec succès');
            };
            reader.readAsDataURL(file);
        }

        function deleteFile(fileId) {
            files = files.filter(f => f.id !== fileId);
            localStorage.setItem('oneboxFiles', JSON.stringify(files));
            renderFilesGrid();
            showToast('Fichier supprimé', 'Le fichier a été supprimé avec succès');
        }

        function downloadFile(fileId) {
            const file = files.find(f => f.id === fileId);
            if (!file || !file.data) return;

            const link = document.createElement('a');
            link.href = file.data;
            link.download = file.originalName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function formatDate(date) {
            const d = new Date(date);
            const now = new Date();
            const diffTime = Math.abs(now.getTime() - d.getTime());
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 1) return 'Il y a 1 jour';
            if (diffDays < 7) return `Il y a ${diffDays} jours`;
            return d.toLocaleDateString('fr-FR');
        }

        function getFileIcon(mimeType) {
            if (mimeType.startsWith('image/')) return 'fas fa-image';
            if (mimeType.includes('pdf')) return 'fas fa-file-pdf';
            if (mimeType.includes('document') || mimeType.includes('text')) return 'fas fa-file-alt';
            return 'fas fa-file';
        }

        function renderFilesGrid() {
            const grid = document.getElementById('filesGrid');
            const emptyState = document.getElementById('emptyState');
            
            if (files.length === 0 && folders.length === 0) {
                emptyState.classList.remove('hidden');
                grid.innerHTML = '';
                grid.appendChild(emptyState);
                return;
            }
            
            emptyState.classList.add('hidden');
            
            let html = '';
            
            // Render folders
            folders.forEach(folder => {
                html += `
                    <div class="bg-card border border-border rounded-xl p-4 file-hover cursor-pointer" data-testid="folder-${folder.id}">
                        <div class="flex items-center justify-between mb-3">
                            <div class="w-10 h-10 bg-green-500/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-folder text-green-400"></i>
                            </div>
                            <div class="relative">
                                <button onclick="toggleDropdown('folder-${folder.id}')" class="p-1 hover:bg-accent rounded transition-colors" data-testid="button-folder-menu-${folder.id}">
                                    <i class="fas fa-ellipsis-h text-sm"></i>
                                </button>
                                <div id="dropdown-folder-${folder.id}" class="hidden absolute right-0 mt-1 w-32 bg-card border border-border rounded-lg shadow-lg z-10">
                                    <button onclick="deleteFolder('${folder.id}')" class="w-full text-left px-3 py-2 text-sm hover:bg-accent rounded transition-colors text-destructive" data-testid="button-delete-folder-${folder.id}">
                                        <i class="fas fa-trash mr-2"></i>Supprimer
                                    </button>
                                </div>
                            </div>
                        </div>
                        <h3 class="font-medium text-foreground truncate" data-testid="text-folder-name-${folder.id}">
                            ${folder.name}
                        </h3>
                        <p class="text-sm text-muted-foreground" data-testid="text-folder-date-${folder.id}">
                            Modifié ${formatDate(folder.createdAt)}
                        </p>
                    </div>
                `;
            });
            
            // Render files
            files.forEach(file => {
                const iconClass = getFileIcon(file.mimeType);
                html += `
                    <div class="bg-card border border-border rounded-xl p-4 file-hover cursor-pointer" onclick="showFilePreview('${file.id}')" data-testid="file-${file.id}">
                        <div class="flex items-center justify-between mb-3">
                            <div class="w-10 h-10 bg-blue-500/20 rounded-lg flex items-center justify-center">
                                <i class="${iconClass} text-blue-400"></i>
                            </div>
                            <div class="relative">
                                <button onclick="event.stopPropagation(); toggleDropdown('file-${file.id}')" class="p-1 hover:bg-accent rounded transition-colors" data-testid="button-file-menu-${file.id}">
                                    <i class="fas fa-ellipsis-h text-sm"></i>
                                </button>
                                <div id="dropdown-file-${file.id}" class="hidden absolute right-0 mt-1 w-32 bg-card border border-border rounded-lg shadow-lg z-10">
                                    <button onclick="downloadFile('${file.id}')" class="w-full text-left px-3 py-2 text-sm hover:bg-accent rounded transition-colors" data-testid="button-download-${file.id}">
                                        <i class="fas fa-download mr-2"></i>Télécharger
                                    </button>
                                    <button onclick="deleteFile('${file.id}')" class="w-full text-left px-3 py-2 text-sm hover:bg-accent rounded transition-colors text-destructive" data-testid="button-delete-file-${file.id}">
                                        <i class="fas fa-trash mr-2"></i>Supprimer
                                    </button>
                                </div>
                            </div>
                        </div>
                        <h3 class="font-medium text-foreground truncate" data-testid="text-file-name-${file.id}">
                            ${file.originalName}
                        </h3>
                        <p class="text-sm text-muted-foreground" data-testid="text-file-details-${file.id}">
                            ${formatFileSize(file.size)} • ${formatDate(file.createdAt)}
                        </p>
                    </div>
                `;
            });
            
            grid.innerHTML = html;
        }

        function toggleDropdown(id) {
            const dropdown = document.getElementById(`dropdown-${id}`);
            dropdown.classList.toggle('hidden');
        }

        function setupDragAndDrop() {
            const uploadZone = document.getElementById('uploadZone');
            
            uploadZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadZone.classList.add('border-accent', 'bg-accent/5');
            });
            
            uploadZone.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('border-accent', 'bg-accent/5');
            });
            
            uploadZone.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadZone.classList.remove('border-accent', 'bg-accent/5');
                
                const droppedFiles = Array.from(e.dataTransfer.files);
                droppedFiles.forEach(file => uploadFile(file));
            });
            
            uploadZone.addEventListener('click', () => {
                document.getElementById('fileInput').click();
            });
        }

        // Editor Functions
        function setupEditorTracking() {
            const titleInput = document.getElementById('documentTitle');
            const editorContent = document.getElementById('editorContent');
            
            titleInput.addEventListener('input', markUnsaved);
            editorContent.addEventListener('input', markUnsaved);
        }

        function markUnsaved() {
            hasUnsavedChanges = true;
            document.getElementById('unsavedIndicator').classList.remove('hidden');
        }

        function handleEditorChange() {
            markUnsaved();
        }

        function execCommand(command, value = null) {
            document.execCommand(command, false, value);
            document.getElementById('editorContent').focus();
        }

        function insertImage() {
            const url = prompt('URL de l\'image:');
            if (url) {
                execCommand('insertImage', url);
            }
        }

        function insertTable() {
            const tableHTML = '<table border="1" style="border-collapse: collapse; width: 100%;"><tr><td style="padding: 8px;">Cell 1</td><td style="padding: 8px;">Cell 2</td></tr><tr><td style="padding: 8px;">Cell 3</td><td style="padding: 8px;">Cell 4</td></tr></table>';
            execCommand('insertHTML', tableHTML);
        }

        function toggleColorPicker() {
            const colorPicker = document.getElementById('colorPicker');
            colorPicker.classList.toggle('hidden');
        }
        
        function setTextColor(color) {
            execCommand('foreColor', color);
            document.getElementById('currentColor').style.backgroundColor = color;
            document.getElementById('colorPicker').classList.add('hidden');
            document.getElementById('editorContent').focus();
        }

        function toggleEditorTheme() {
            editorDarkMode = !editorDarkMode;
            const container = document.getElementById('editorContainer');
            const icon = document.getElementById('themeIcon');
            
            if (editorDarkMode) {
                container.className = 'max-w-4xl mx-auto rounded-lg shadow-lg min-h-full p-8 bg-card text-foreground';
                icon.className = 'fas fa-sun text-muted-foreground';
            } else {
                container.className = 'max-w-4xl mx-auto rounded-lg shadow-lg min-h-full p-8 bg-white text-black';
                icon.className = 'fas fa-moon text-muted-foreground';
            }
        }

        function saveDocument() {
            const title = document.getElementById('documentTitle').value || 'Document sans titre';
            const content = document.getElementById('editorContent').innerHTML;
            
            const document = {
                id: generateId(),
                title: title,
                content: content,
                createdAt: new Date().toISOString(),
                userId: currentUser.id
            };
            
            documents.push(document);
            localStorage.setItem('oneboxDocuments', JSON.stringify(documents));
            
            // Ajouter le document aussi comme fichier dans la section stockage
            const fileRecord = {
                id: generateId(),
                originalName: title + '.html',
                size: new Blob([content]).size,
                mimeType: 'text/html',
                createdAt: new Date().toISOString(),
                userId: currentUser.id,
                data: 'data:text/html;base64,' + btoa(content)
            };
            
            files.push(fileRecord);
            localStorage.setItem('oneboxFiles', JSON.stringify(files));
            
            hasUnsavedChanges = false;
            document.getElementById('unsavedIndicator').classList.add('hidden');
            
            showToast('Document sauvegardé', 'Votre document a été sauvegardé avec succès et ajouté à vos fichiers');
        }

        // File Preview Functions
        let currentPreviewFileId = null;
        
        function showFilePreview(fileId) {
            const file = files.find(f => f.id === fileId);
            if (!file) return;
            
            currentPreviewFileId = fileId;
            
            // Update modal content
            document.getElementById('previewFileName').textContent = file.originalName;
            document.getElementById('previewFileInfo').textContent = `${formatFileSize(file.size)} • ${file.mimeType}`;
            document.getElementById('previewFileDate').textContent = `Créé le ${formatDate(file.createdAt)}`;
            
            // Generate preview content
            const previewContent = document.getElementById('previewContent');
            
            if (file.mimeType.startsWith('image/')) {
                previewContent.innerHTML = `
                    <div class="text-center">
                        <img src="${file.data}" alt="${file.originalName}" class="max-w-full max-h-96 mx-auto rounded-lg shadow-md" style="object-fit: contain;">
                    </div>
                `;
            } else if (file.mimeType === 'text/plain' || file.mimeType.includes('text')) {
                // Pour les fichiers texte, on essaie de décoder le contenu
                try {
                    const textContent = atob(file.data.split(',')[1]);
                    previewContent.innerHTML = `
                        <div class="bg-muted/20 rounded-lg p-4 max-h-64 overflow-y-auto">
                            <pre class="whitespace-pre-wrap text-sm">${textContent}</pre>
                        </div>
                    `;
                } catch (e) {
                    previewContent.innerHTML = `
                        <div class="text-center py-8">
                            <i class="fas fa-file-alt text-6xl text-muted-foreground mb-4"></i>
                            <p class="text-muted-foreground">Impossible de prévisualiser ce fichier texte</p>
                        </div>
                    `;
                }
            } else {
                const iconClass = getFileIcon(file.mimeType);
                previewContent.innerHTML = `
                    <div class="text-center py-8">
                        <i class="${iconClass} text-6xl text-muted-foreground mb-4"></i>
                        <p class="text-muted-foreground">Prévisualisation non disponible pour ce type de fichier</p>
                        <p class="text-sm text-muted-foreground mt-2">Utilisez le bouton télécharger pour ouvrir le fichier</p>
                    </div>
                `;
            }
            
            // Show modal
            document.getElementById('filePreviewModal').classList.remove('hidden');
        }
        
        function closeFilePreview() {
            document.getElementById('filePreviewModal').classList.add('hidden');
            currentPreviewFileId = null;
        }
        
        function downloadFileFromPreview() {
            if (currentPreviewFileId) {
                downloadFile(currentPreviewFileId);
            }
        }
        
        function deleteFileFromPreview() {
            if (currentPreviewFileId) {
                deleteFile(currentPreviewFileId);
                closeFilePreview();
            }
        }

        // Profile Functions
        function saveProfile() {
            const username = document.getElementById('profileUsername').value;
            if (currentUser && username) {
                currentUser.username = username;
                localStorage.setItem('oneboxUser', JSON.stringify(currentUser));
                document.getElementById('userNameDisplay').textContent = username;
                showToast('Profil mis à jour', 'Vos modifications ont été sauvegardées');
            }
        }

        // Global Event Listeners
        document.addEventListener('click', function(event) {
            const profileButton = event.target.closest('[onclick="toggleProfileMenu()"]');
            const profileMenu = document.getElementById('profileMenu');
            
            if (!profileButton && !profileMenu.contains(event.target)) {
                hideProfileMenu();
            }

            // Close mobile menu when clicking outside
            const mobileMenuButton = event.target.closest('[onclick="toggleMobileMenu()"]');
            const mobileMenu = document.getElementById('mobileMenu');
            
            if (!mobileMenuButton && !mobileMenu.contains(event.target)) {
                closeMobileMenu();
            }

            // Close dropdowns when clicking outside
            if (!event.target.closest('[onclick*="toggleDropdown"]') && !event.target.closest('[id*="dropdown-"]')) {
                document.querySelectorAll('[id*="dropdown-"]').forEach(dropdown => {
                    dropdown.classList.add('hidden');
                });
            }
            
            // Close color picker when clicking outside
            const colorPickerButton = event.target.closest('[onclick="toggleColorPicker()"]');
            const colorPicker = document.getElementById('colorPicker');
            
            if (!colorPickerButton && !colorPicker.contains(event.target)) {
                colorPicker.classList.add('hidden');
            }
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideProfileMenu();
                closeMobileMenu();
                document.querySelectorAll('[id*="dropdown-"]').forEach(dropdown => {
                    dropdown.classList.add('hidden');
                });
            }
            
            // Save document shortcut
            if (event.ctrlKey && event.key === 's' && currentSection === 'editor') {
                event.preventDefault();
                saveDocument();
            }
            
            // Navigation shortcuts (when authenticated)
            if (currentUser && event.altKey) {
                switch(event.key) {
                    case '1':
                        showSection('home');
                        break;
                    case '2':
                        showSection('storage');
                        break;
                    case '3':
                        showSection('editor');
                        break;
                    case '4':
                        showSection('help');
                        break;
                }
            }
        });

        // Form submit handlers for Enter key
        document.getElementById('newFolderName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                createFolder();
            }
        });

        // Initialize interactive elements
        document.addEventListener('DOMContentLoaded', function() {
            // Add visual feedback for button clicks
            const buttons = document.querySelectorAll('button');
            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    this.style.transform = 'scale(0.98)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            });
        });

        // Mobile Menu Functions
        function toggleMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        }

        function closeMobileMenu() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.add('hidden');
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Close modals when clicking outside
        document.addEventListener('click', function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.classList.add('hidden');
                }
            });
        });

        // Close modals with Escape key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.classList.add('hidden');
                });
            }
        });
    </script>

    <!-- Upload Tutorial Modal -->
    <div id="uploadTutorialModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" data-testid="modal-upload-tutorial">
        <div class="bg-card border border-border rounded-xl p-8 max-w-2xl max-h-[80vh] overflow-y-auto m-4">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-foreground">📁 Tutoriel : Upload de fichiers</h2>
                <button onclick="closeModal('uploadTutorialModal')" class="text-muted-foreground hover:text-foreground" data-testid="button-close-upload-modal">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-6 text-muted-foreground">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">1</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Glisser-déposer</h3>
                        <p>Faites simplement glisser vos fichiers depuis votre explorateur vers la zone de stockage OneBox. C'est la méthode la plus rapide !</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">2</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Bouton Importer</h3>
                        <p>Cliquez sur le bouton "📁 Importer fichiers" dans la section Stockage pour ouvrir l'explorateur de fichiers et sélectionner vos documents.</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">3</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Formats supportés</h3>
                        <p>Tous les types de fichiers sont acceptés : images (JPG, PNG, GIF), documents (PDF, DOC, TXT), vidéos, et bien plus encore.</p>
                    </div>
                </div>
                
                <div class="bg-accent/10 border border-accent/20 rounded-lg p-4 mt-6">
                    <h4 class="text-accent font-semibold mb-2">💡 Astuce pro</h4>
                    <p class="text-sm">Vous pouvez sélectionner plusieurs fichiers à la fois en maintenant Ctrl (ou Cmd sur Mac) enfoncé !</p>
                </div>
            </div>
            
            <div class="flex justify-end mt-8">
                <button onclick="closeModal('uploadTutorialModal')" class="bg-accent text-accent-foreground px-6 py-2 rounded-lg hover:bg-accent/90 transition-colors">
                    Compris !
                </button>
            </div>
        </div>
    </div>

    <!-- Editor Tutorial Modal -->
    <div id="editorTutorialModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" data-testid="modal-editor-tutorial">
        <div class="bg-card border border-border rounded-xl p-8 max-w-2xl max-h-[80vh] overflow-y-auto m-4">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-foreground">✏️ Tutoriel : Éditeur de documents</h2>
                <button onclick="closeModal('editorTutorialModal')" class="text-muted-foreground hover:text-foreground" data-testid="button-close-editor-modal">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-6 text-muted-foreground">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">1</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Créer un document</h3>
                        <p>Accédez à la section "Éditeur" depuis le menu. Un nouveau document vierge s'ouvrira automatiquement.</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">2</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Outils de formatage</h3>
                        <p>Utilisez la barre d'outils pour formater votre texte : <strong>gras</strong>, <em>italique</em>, soulignement, alignement, et insertion d'images ou tableaux.</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">3</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Sauvegarde automatique</h3>
                        <p>Vos modifications sont détectées automatiquement. Cliquez sur "Sauvegarder" ou utilisez Ctrl+S pour enregistrer votre document.</p>
                    </div>
                </div>
                
                <div class="bg-accent/10 border border-accent/20 rounded-lg p-4 mt-6">
                    <h4 class="text-accent font-semibold mb-2">⌨️ Raccourcis clavier</h4>
                    <div class="text-sm space-y-1">
                        <p><kbd class="bg-secondary px-2 py-1 rounded">Ctrl + S</kbd> : Sauvegarder le document</p>
                        <p><kbd class="bg-secondary px-2 py-1 rounded">Ctrl + B</kbd> : Mettre en gras</p>
                        <p><kbd class="bg-secondary px-2 py-1 rounded">Ctrl + I</kbd> : Mettre en italique</p>
                    </div>
                </div>
            </div>
            
            <div class="flex justify-end mt-8">
                <button onclick="closeModal('editorTutorialModal')" class="bg-accent text-accent-foreground px-6 py-2 rounded-lg hover:bg-accent/90 transition-colors">
                    Parfait !
                </button>
            </div>
        </div>
    </div>

    <!-- Sharing Tutorial Modal -->
    <div id="sharingTutorialModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" data-testid="modal-sharing-tutorial">
        <div class="bg-card border border-border rounded-xl p-8 max-w-2xl max-h-[80vh] overflow-y-auto m-4">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-foreground">🔗 Tutoriel : Partage de fichiers</h2>
                <button onclick="closeModal('sharingTutorialModal')" class="text-muted-foreground hover:text-foreground" data-testid="button-close-sharing-modal">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-6 text-muted-foreground">
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">1</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Accès local uniquement</h3>
                        <p>OneBox fonctionne en mode local pour votre sécurité. Vos fichiers restent sur votre appareil et ne sont pas partagés sur internet.</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">2</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Partage par téléchargement</h3>
                        <p>Pour partager un fichier, utilisez le bouton "Télécharger" dans le menu du fichier, puis envoyez-le via email, messagerie, ou clé USB.</p>
                    </div>
                </div>
                
                <div class="flex items-start space-x-3">
                    <div class="w-8 h-8 bg-accent rounded-full flex items-center justify-center text-accent-foreground font-bold">3</div>
                    <div>
                        <h3 class="text-foreground font-semibold mb-2">Synchronisation manuelle</h3>
                        <p>Pour accéder à vos fichiers depuis un autre appareil, exportez vos données et importez-les sur l'autre appareil.</p>
                    </div>
                </div>
                
                <div class="bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4 mt-6">
                    <h4 class="text-yellow-500 font-semibold mb-2">🔒 Sécurité avant tout</h4>
                    <p class="text-sm">Cette approche locale garantit que vos données privées ne quittent jamais votre appareil, offrant une sécurité maximale.</p>
                </div>
            </div>
            
            <div class="flex justify-end mt-8">
                <button onclick="closeModal('sharingTutorialModal')" class="bg-accent text-accent-foreground px-6 py-2 rounded-lg hover:bg-accent/90 transition-colors">
                    C'est noté !
                </button>
            </div>
        </div>
    </div>

    <!-- File Preview Modal -->
    <div id="filePreviewModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" data-testid="modal-file-preview">
        <div class="bg-card border border-border rounded-xl max-w-4xl max-h-[90vh] overflow-y-auto m-4 w-full">
            <div class="flex items-center justify-between p-6 border-b border-border">
                <h2 id="previewFileName" class="text-xl font-bold text-foreground">Prévisualisation du fichier</h2>
                <button onclick="closeFilePreview()" class="text-muted-foreground hover:text-foreground" data-testid="button-close-preview">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="p-6">
                <div id="previewContent" class="mb-6">
                    <!-- Le contenu de prévisualisation sera inséré ici -->
                </div>
                
                <div class="flex items-center justify-between bg-muted/20 rounded-lg p-4">
                    <div>
                        <p id="previewFileInfo" class="text-sm text-muted-foreground"></p>
                        <p id="previewFileDate" class="text-xs text-muted-foreground mt-1"></p>
                    </div>
                    <div class="flex space-x-2">
                        <button id="previewDownloadBtn" onclick="downloadFileFromPreview()" class="bg-primary text-primary-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-preview-download">
                            <i class="fas fa-download mr-2"></i>Télécharger
                        </button>
                        <button id="previewDeleteBtn" onclick="deleteFileFromPreview()" class="bg-destructive text-destructive-foreground px-4 py-2 rounded-lg hover:opacity-90 transition-opacity" data-testid="button-preview-delete">
                            <i class="fas fa-trash mr-2"></i>Supprimer
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Modal with 3D Snapchat Style -->
    <div id="contactModal" class="modal hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50" data-testid="modal-contact">
        <div class="relative bg-gradient-to-br from-yellow-400 via-pink-500 to-purple-600 p-1 rounded-3xl transform transition-all duration-300 hover:scale-105 m-4">
            <div class="bg-black rounded-3xl p-8 max-w-md relative overflow-hidden">
                <!-- 3D Background Effect -->
                <div class="absolute inset-0 bg-gradient-to-r from-purple-600/20 via-pink-500/20 to-yellow-400/20 animate-pulse"></div>
                <div class="absolute -top-10 -right-10 w-32 h-32 bg-yellow-400/30 rounded-full blur-3xl"></div>
                <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-purple-600/30 rounded-full blur-3xl"></div>
                
                <!-- Content -->
                <div class="relative z-10">
                    <div class="flex items-center justify-between mb-6">
                        <div class="flex items-center space-x-3">
                            <div class="w-12 h-12 bg-gradient-to-r from-yellow-400 to-pink-500 rounded-2xl flex items-center justify-center transform rotate-12">
                                <i class="fab fa-snapchat-ghost text-black text-xl"></i>
                            </div>
                            <h2 class="text-2xl font-bold text-white">Contact</h2>
                        </div>
                        <button onclick="closeModal('contactModal')" class="text-white/70 hover:text-white transition-colors" data-testid="button-close-contact-modal">
                            <i class="fas fa-times text-xl"></i>
                        </button>
                    </div>
                    
                    <div class="space-y-6">
                        <div class="text-center">
                            <div class="inline-block p-4 bg-gradient-to-r from-yellow-400/20 to-pink-500/20 rounded-2xl mb-4 transform hover:rotate-3 transition-transform">
                                <i class="fas fa-rocket text-4xl text-white"></i>
                            </div>
                            <h3 class="text-xl font-semibold text-white mb-2">Rejoignez-nous sur Snapchat!</h3>
                            <p class="text-white/80 mb-6">Suivez nos dernières actualités et nouveautés sur notre Snap officiel.</p>
                        </div>
                        
                        <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-6 border border-white/20">
                            <div class="flex items-center space-x-3 mb-4">
                                <i class="fab fa-snapchat text-yellow-400 text-2xl"></i>
                                <span class="text-white font-semibold">OneBox Officiel</span>
                            </div>
                            <p class="text-white/80 text-sm mb-4">Scannez le code Snapchat ou cliquez sur le lien ci-dessous</p>
                            
                            <!-- Snapchat Link Button -->
                            <a href="https://t.snapchat.com/EmDLdFsT" target="_blank" class="block w-full bg-gradient-to-r from-yellow-400 to-pink-500 text-black font-bold py-3 px-6 rounded-xl text-center transform transition-all duration-200 hover:scale-105 hover:shadow-lg active:scale-95">
                                <i class="fab fa-snapchat mr-2"></i>
                                Ouvrir sur Snapchat
                            </a>
                        </div>
                        
                        <div class="text-center">
                            <div class="inline-flex items-center space-x-2 text-white/60 text-sm">
                                <i class="fas fa-shield-alt"></i>
                                <span>Lien officiel sécurisé</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Animated particles -->
                <div class="absolute top-4 right-4 w-2 h-2 bg-yellow-400 rounded-full animate-bounce" style="animation-delay: 0.5s;"></div>
                <div class="absolute bottom-6 left-6 w-1 h-1 bg-pink-500 rounded-full animate-bounce" style="animation-delay: 1s;"></div>
                <div class="absolute top-1/3 left-4 w-1.5 h-1.5 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 1.5s;"></div>
            </div>
        </div>
    </div>
</body>
</html>